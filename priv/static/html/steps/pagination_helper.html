<p>
  This section explains the rationale behind creating a purely functional
  pagination helper module. If you haven't reviewed the initial pagination setup
  in the previous section, it's recommended to
  <a href="/steps/paginated">start there</a> to understand the complete context
  and functionality of the code being refactored.
</p>

<h3>Core Design Goals</h3>
<ul>
  <li>Make pagination reusable across all LiveViews</li>
  <li>Keep all pagination settings in one place</li>
  <li>
    Keep pagination logic separate from LiveView lifecycle - the helper just
    handles data, while LiveView handles UI updates
  </li>
</ul>

<h3>The Pagination Context</h3>
<p>
  Instead of passing multiple settings around, we use a simple
  <code>Context</code> struct that holds configuration like
  <code>per_page_options</code> and <code>default_per_page</code>. This struct
  lives in your LiveView's assigns as
  <code>socket.assigns.pagination_context</code>.
</p>

<h3>Key Functions</h3>

<h4>Setting Up Pagination</h4>
<ul>
  <li>
    <code>convert_params</code>: Determines pagination values from either user
    input parameters, existing options, or context defaults, converting string
    inputs to proper numbers when needed
  </li>
  <li>
    <code>validate_options</code>: Makes sure page numbers and items per page
    stay within allowed ranges
  </li>
  <li>
    <code>init</code>: Sets up initial pagination state with counts and settings
  </li>
</ul>

<h4>Handling Changes</h4>
<ul>
  <li>
    <code>apply_options</code>: Handles pagination changes (like page number)
    and tells LiveView if it needs to reload data
  </li>
  <li>
    <code>update_per_page_option</code>: Updates how many items show per page
    when user changes this setting
  </li>
</ul>

<h4>Managing Items</h4>
<ul>
  <li>
    <code>handle_created</code>: Updates counts when new items are added and
    marks them as new
  </li>
  <li><code>handle_updated</code>: Marks items that have been changed</li>
  <li>
    <code>handle_deleted</code>: Updates counts when items are removed and marks
    them for deletion
  </li>
</ul>

<h4>Template Helper</h4>
<ul>
  <li>
    <code>get_summary</code>: Creates readable text like "Showing 1 - 20 of 100"
    for displaying pagination status
  </li>
</ul>

<p>
  This clean separation makes the code easier to test and maintain. Each helper
  function does one thing well, working with just the data it needs. The
  LiveView remains in charge of the UI, handling all the visual updates and user
  interactions.
</p>
